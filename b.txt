Perfect üëç since you're using classic ADO.NET (SqlConnection / SqlCommand), below is clean, fully parameterized CRUD for your table:

tbl_AP_VendorAiMapping
(
    Id (PK, Identity)
    SiteCode
    ExtractedVendorText
    VendorId
    VendorKey
    VendorName
    CreatedAt (default)
    CreatedBy
    IsActive
)


---

üîπ INSERT (Create)

public void InsertVendorMapping(
    string siteCode,
    string extractedVendorText,
    int vendorId,
    int vendorKey,
    string vendorName,
    Guid? createdBy)
{
    const string sql = @"
        INSERT INTO tbl_AP_VendorAiMapping
        (SiteCode, ExtractedVendorText, VendorId, VendorKey, VendorName, CreatedBy)
        VALUES
        (@SiteCode, @ExtractedVendorText, @VendorId, @VendorKey, @VendorName, @CreatedBy)";

    using (var conn = new SqlConnection(connectionString))
    using (var cmd = new SqlCommand(sql, conn))
    {
        cmd.Parameters.Add("@SiteCode", SqlDbType.NVarChar, 50).Value = siteCode;
        cmd.Parameters.Add("@ExtractedVendorText", SqlDbType.NVarChar, 500).Value = extractedVendorText;
        cmd.Parameters.Add("@VendorId", SqlDbType.Int).Value = vendorId;
        cmd.Parameters.Add("@VendorKey", SqlDbType.Int).Value = vendorKey;
        cmd.Parameters.Add("@VendorName", SqlDbType.NVarChar, 200).Value = vendorName;
        cmd.Parameters.Add("@CreatedBy", SqlDbType.UniqueIdentifier).Value =
            (object?)createdBy ?? DBNull.Value;

        conn.Open();
        cmd.ExecuteNonQuery();
    }
}


---

üîπ SELECT by Site + ExtractedVendorText (Lookup)

public VendorMapping GetVendorMapping(string siteCode, string extractedVendorText)
{
    const string sql = @"
        SELECT TOP 1 *
        FROM tbl_AP_VendorAiMapping
        WHERE SiteCode = @SiteCode
          AND ExtractedVendorText = @ExtractedVendorText
          AND IsActive = 1";

    using (var conn = new SqlConnection(connectionString))
    using (var cmd = new SqlCommand(sql, conn))
    {
        cmd.Parameters.Add("@SiteCode", SqlDbType.NVarChar, 50).Value = siteCode;
        cmd.Parameters.Add("@ExtractedVendorText", SqlDbType.NVarChar, 500).Value = extractedVendorText;

        conn.Open();

        using (var reader = cmd.ExecuteReader())
        {
            if (!reader.Read())
                return null;

            return new VendorMapping
            {
                Id = (int)reader["Id"],
                SiteCode = reader["SiteCode"].ToString(),
                ExtractedVendorText = reader["ExtractedVendorText"].ToString(),
                VendorId = (int)reader["VendorId"],
                VendorKey = (int)reader["VendorKey"],
                VendorName = reader["VendorName"].ToString(),
                IsActive = (bool)reader["IsActive"]
            };
        }
    }
}


---

üîπ UPDATE

public void UpdateVendorMapping(
    int id,
    int vendorId,
    int vendorKey,
    string vendorName,
    bool isActive)
{
    const string sql = @"
        UPDATE tbl_AP_VendorAiMapping
        SET VendorId = @VendorId,
            VendorKey = @VendorKey,
            VendorName = @VendorName,
            IsActive = @IsActive
        WHERE Id = @Id";

    using (var conn = new SqlConnection(connectionString))
    using (var cmd = new SqlCommand(sql, conn))
    {
        cmd.Parameters.Add("@Id", SqlDbType.Int).Value = id;
        cmd.Parameters.Add("@VendorId", SqlDbType.Int).Value = vendorId;
        cmd.Parameters.Add("@VendorKey", SqlDbType.Int).Value = vendorKey;
        cmd.Parameters.Add("@VendorName", SqlDbType.NVarChar, 200).Value = vendorName;
        cmd.Parameters.Add("@IsActive", SqlDbType.Bit).Value = isActive;

        conn.Open();
        cmd.ExecuteNonQuery();
    }
}


---

üîπ DELETE (Soft Delete Recommended)

Since you already have IsActive, better to soft delete:

public void DeactivateVendorMapping(int id)
{
    const string sql = @"
        UPDATE tbl_AP_VendorAiMapping
        SET IsActive = 0
        WHERE Id = @Id";

    using (var conn = new SqlConnection(connectionString))
    using (var cmd = new SqlCommand(sql, conn))
    {
        cmd.Parameters.Add("@Id", SqlDbType.Int).Value = id;

        conn.Open();
        cmd.ExecuteNonQuery();
    }
}


---

üîπ VendorMapping Model

public class VendorMapping
{
    public int Id { get; set; }
    public string SiteCode { get; set; }
    public string ExtractedVendorText { get; set; }
    public int VendorId { get; set; }
    public int VendorKey { get; set; }
    public string VendorName { get; set; }
    public bool IsActive { get; set; }
}


---

üî• Production Improvement Suggestion

For better matching reliability:

Instead of:

ExtractedVendorText = @ExtractedVendorText

Use:

LOWER(LTRIM(RTRIM(ExtractedVendorText))) = LOWER(LTRIM(RTRIM(@ExtractedVendorText)))

That avoids whitespace/case issues.


---

If you want, I can next give you:

A Repository pattern version

Async ADO.NET version

Or a stored procedure version

Or automatic insert-if-not-exists logic for vendor learning


Tell me which direction you're going next üöÄ